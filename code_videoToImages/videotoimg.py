import cv2
import os
import queue
import time
import threading
q=queue.Queue()
'''
定义保存图片的函数
image：要保存的图片
addr：图片的地址和名称信息
num图片名称的后缀，使用int类型来计数
'''
def save_image(image,addr,num):
    address = addr + str(num) + '.jpg'
    print('address',address)
    cv2.imwrite(address,image)
def vede_convert_img(path2, n, count):
    vode_path = path2 + '\\' + n
    print(vode_path)
    vode = cv2.VideoCapture(vode_path) # D:\project_data\车牌视频\云竹路\50010500001320000001_50010500001321000001_20220928153000.mp4

    #   读帧
    success, frame = vode.read()
    #   初始化变量
    i = 0  # 帧计数
    j = 0  # 图片计数

    timeF = 25  # 每隔57帧（一秒）保存一张图片，这个要看自己的视频每秒是多少帧

    while success:
        i = i + 1
        if (i % timeF == 0):
            j = i + 1
            save_image(frame, 'D:\project_data\license_color\images\\' + n[:-4] + '_', count)
            print('save image:', count)
            count += 1
        success, frame = vode.read()
    # return count

# path_lst = []
#   读取视频文件
path = r'D:\project_data\车牌视频'
count = 0
for p in os.listdir(path):
    path2 = path+ '\\'+ p
    print(path2)
    # print(os.listdir(path2))
    # path_lst += os.listdir(path2)

    for i in os.listdir(path2):
        # print(i)
        vede_convert_img(path2, i, count)

'''
云竹路
50010500001320000001_50010500001321000001_20220928153000_1000.jpg      1001
50010500001320000001_50010500001321000001_20220929083000_1798.jpg      1799  total
50010500001320000001_50010500001321000001_20221003163000_1796.jpg      1797  4597
50010500001320000001_50010500001321000001_20221004180000_1794.jpg      1795  6392
50010500001320000001_50010500001321000001_20221006090000_1797.jpg      1798  
50010500001320000001_50010500001321000001_20221007180000_1794.jpg      1795  9985
50010500001320000001_50010500001321000001_20221009160000_1798.jpg      1799
50010500001320000001_50010500001321000001_20221010080000 (1)_1794.jpg  1795
50010500001320000001_50010500001321000001_20221010080000_1794.jpg      1795  15374
海尔路
34020000001320000052_34020000001321000052_20220925162608_235.jpg       236
34020000001320000052_34020000001321000052_20220927153000_1798.jpg      1799
34020000001320000052_34020000001321000052_20220927160000_1798.jpg      1799
34020000001320000052_34020000001321000052_20220928080000_1797.jpg      1798
34020000001320000052_34020000001321000052_20220928083000_1797.jpg      1798  22804
翠莲路
50010500001320000002_50010500001321000002_20220926140000_1797.jpg      1798
50010500001320000002_50010500001321000002_20220927110000_1797.jpg      1798
50010500001320000002_50010500001321000002_20220928130000_1797.jpg      1798
50010500001320000002_50010500001321000002_20220929090000_1797.jpg      1798
50010500001320000002_50010500001321000002_20221004080002_1799.jpg      1800
50010500001320000002_50010500001321000002_20221004160001_1800.jpg      1801
50010500001320000002_50010500001321000002_20221009170000_1794.jpg      1795
50010500001320000002_50010500001321000002_20221009180000_1799.jpg      1800
50010500001320000002_50010500001321000002_20221010080000_1798.jpg      1799
50010500001320000002_50010500001321000002_20221010083000_1798.jpg      1800
'''















